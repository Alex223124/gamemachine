#!/usr/bin/env ruby

require 'rubygems'
require 'trollop'
require 'fileutils'

begin
  require 'game_machine'
rescue LoadError
  require_relative '../lib/game_machine'
end

opts = Trollop::options do
  opt :cluster, "run in cluster mode", :type => :string
  opt :console, "Start a console", :type => :string
  opt :name, "Config name, defaults to 'default'", :type => :string
  opt :config, "Config file, defaults to  config/config.yml", :type => :string
  version "GameMachine 0.0.1"
  banner <<-EOS
Usage:
EOS
end
opts[:name].strip! if opts[:name]
opts[:config].strip! if opts[:config]
opts[:cluster].strip! if opts[:cluster]

if opts[:config]
  ENV['CONFIG_FILE'] = opts[:config]
end

console = opts[:console] || false
cluster = opts[:cluster] || false

name = opts[:name] || 'default'
GameMachine::Runner.start(name,cluster,console)

